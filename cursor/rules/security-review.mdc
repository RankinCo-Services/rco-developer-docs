---
description: On every code change, run the security-compliance subagent before commit; only recommend commit if compliance passes or is explicitly approved.
alwaysApply: true
---

# Security review on every code change

- **Automatic review:** For every code change (before recommending or proceeding with commit), the agent **must** run a security compliance review. There are no exceptions—every change set that is about to be committed must be reviewed by the security-compliance subagent. The subagent applies RCO security rules and, for Beacon/Beacon-based apps, the secondary app (Beacon architecture) rules.
- Launch the **security-compliance** subagent with the current diff (staged or unstaged) and any relevant context.
- **Make the review visible:** After running the subagent, you **must** tell the user that the security-compliance review was run and show the report summary in the conversation (Result: PASS/FAIL, Rules checked, Violations, and Recommendation). Do not recommend commit without first showing this summary so the user can verify the review ran.
- Only recommend committing if the subagent’s report is **PASS**, or the user has explicitly approved documented exceptions.
- If the report is **FAIL**, list the findings and suggest fixes; do not recommend commit until issues are fixed or the user approves an exception.
- **Show that recommendations were addressed:** Before recommending commit after a FAIL, you **must** make it visible how each subagent recommendation was handled. Either (1) **re-run the security-compliance subagent** on the updated changes and show the new report (PASS or remaining findings), or (2) list each finding with **"Fixed: [brief description of change]"** or **"Approved exception: [user approved]"** so the user can verify that recommendations were implemented or explicitly accepted. Do not recommend commit until you have shown this.
- **Do not skip or violate** these review requirements (running the subagent, acting on PASS/FAIL and Beacon rules) unless there is a **compelling reason**. If you have a compelling reason to skip the review or to proceed despite a FAIL or rule violation: (1) **describe the issue** to the user, (2) **outline your plan** (what you will do and why the violation is necessary), and (3) **await explicit user authorization** before proceeding. Do not proceed with the violation until the user authorizes.
- This rule is always applied so that the subagent is invoked automatically as part of the commit workflow for every change.
